<link rel="stylesheet" href="../../css/bootstrap.css">
<link rel="stylesheet" href="../../css/bootstrap.min.css">
<link rel="stylesheet" href="../../css/style.css">
<script src="https://d3js.org/d3.v4.min.js"></script>

<div class ="content-sub">
  <div class="container">
	<style> /* set the CSS */

	.skillText{
		fill: #6B6B6B;
		font-size: 16px;
		font-family: 'Courgette', sans-serif;
	}
	svg {
		padding: 0;
		margin: 3%;
		width: 960;
		height: 720;
	}
	div.tooltip {	
	    position: absolute;			
	    text-align: center;						
	    font: 12px sans-serif;		
	    background: lightsteelblue;	
	    border: 0px;		
	    border-radius: 8px;			
	    pointer-events: none;			
	}
	</style>

  	<script>



    var svg = d3.select(".container").append("svg")


	d3.csv("data.csv", function(error, data){
		if(error) throw error;

	  	var numSides = data.length;
	  	var levels = 5;
	  	var increment = 30;
	  	var radius = 300;
	  	var cords = [];
	  	var xMid = 480;
	  	var yMid = 350;


		data.forEach(function(d, i) {
			d.level = parseInt(d.level);
			d.skill = d.skill
			d.x = Math.sin(2*Math.PI*(i/numSides))*(radius-(5-d.level)*increment)+xMid;
			d.y = Math.cos(2*Math.PI*(i/numSides))*(radius-(5-d.level)*increment)+yMid;
			d.notes = d.notes
		});

		var flatline = d3.line()
		    .x(function(d) { return d.x; })
		    .y(function(d) { return d.y; });

		var div = d3.select("body").append("div")	
		    .attr("class", "tooltip")				
		    .style("opacity", 0);

	  	for (i=0; i<levels; i++){
	  		var tmpCords = [];
		  	for (j = 0; j<numSides; j++){
		  		tmpCords.push({
		  			x:Math.sin(2*Math.PI*(j/numSides))*(radius-i*increment)+xMid, 
		  			y:Math.cos(2*Math.PI*(j/numSides))*(radius-i*increment)+yMid});
		  	}
		  	cords.push(tmpCords);
		}

	    for (i=0; i<levels; i++){

			svg.append("path")
				.data([cords[i]])
				.attr("stroke", "steelblue")
				.attr("class", "line")
				.attr("d", function(d, r){return flatline(d)+"Z"})
				.attr("fill", "none")
				.attr("stroke-width", 2);
		};


	    var valueline= d3.line()
		    .x(function(d) { return d.x; })
		    .y(function(d) { return d.y; });

	    var radline= d3.radialLine()
		    .angle(function(d, i) { return 2*Math.PI*(i/numSides); })
		    .radius(function(d) { return 80; });


		svg.append("path")
			.data([data])
			.attr("stroke", "green")
			.attr("d", function(d){return valueline(d)+"Z"})
			.attr("fill", "lightgreen")
			.attr("opacity", 0.3)
			.attr("stroke-width", 2);

		svg.selectAll("skillPoint")
			.data(data)
			.enter()
			.append("circle")
			.attr("r", 3)
			.attr("fill", "black")
			.attr("opacity", 0.5)
			.attr("cx", function(d){return d.x;})
			.attr("cy", function(d){return d.y;})
	        .on("mouseover", function(d) {		
	            div.transition()		
	                .duration(200)		
	                .style("opacity", .9);		
	            div	.html(d.notes)		
	                .style("left", (d3.event.pageX) + "px")		
	                .style("top", (d3.event.pageY - 28) + "px")
	                .style("width", "200px")
	                .style("height", "100px");	
	            })					
	        	.on("mouseout", function(d) {		
		            div.transition()		
		                .duration(500)		
		                .style("opacity", 0);	
        }) 	;

		var sktext = svg.selectAll(".skillText")
			.data(data)
			.enter().append("text")
			.attr("class", "skillText")
			.attr("x", function(d, i){return Math.sin(2*Math.PI*(i/numSides))*(radius+increment*3)+xMid;}) //Move the text from the start angle of the arc
			.attr("y", function(d, i){return Math.cos(2*Math.PI*(i/numSides))*(radius+increment)+yMid+10;}) //Move the text down
			.text(function(d){return d.skill;});	

		sktext.style("text-anchor", "middle")
	})



	</script>
  </div>
</div>  